openapi: 3.0.1
info:
  title: TestCase
  version: '1.0'
servers:
  - url: '/api/v1'
paths: {}
components:
  schemas:
    RootSchema:
      allOf:
        - $ref: "#/components/schemas/SchemaA"
        - $ref: "#/components/schemas/SchemaB"

    SchemaA:
      allOf:
        - $ref: "#/components/schemas/SchemaC"
        - type: object

    SchemaB:
      allOf:
        - type: string
        - $ref: "#/components/schemas/SchemaC"

    SchemaC:
      allOf:
        - type: object
        - $ref: "#/components/schemas/SchemaD"
      oneOf:
        - type: object
        - type: string

    SchemaD:
      type: object
      allOf:
        - $ref: "#/components/schemas/SchemaC"


# te onderzoeken - werkt circulaire dependency check overijverig voor gevallen zoals:

    SchemaWithSharedSubschema: # should be invalid
      allOf:
        - oneOf: # this part allows only string or object
          - $ref: "#/components/schemas/FirstChild"
          - $ref: "#/components/schemas/SecondChild"
        - type: integer

    Parent:
      type: object

    FirstChild:
      type: object
      allOf:
        - $ref: "#/components/schemas/Parent"

    SecondChild:
      oneOf:
        - $ref: "#/components/schemas/Parent"
        - type: string

    SchemaOneOfAnyTypeAllowed:
      oneOf:
        - type: object
        - {}

    SchemaValidCombination:
      allOf:
       - $ref: "#/components/schemas/SchemaOneOfAnyTypeAllowed"
       - type: integer